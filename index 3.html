<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Turbo Turf Trimmer</title>
  <style>
    body { margin:0; background:#000; color:#0f0; font-family:monospace; overflow:hidden; }
    #hud { position:fixed; top:10px; left:10px; color:#0f0; background:rgba(0,0,0,0.5); padding:8px; border:1px solid #0f0; }
    #best { margin-top:6px; }
    #intro, #complete { position:fixed; top:0; left:0; right:0; bottom:0; background:#000; color:#0f0;
                       display:flex; flex-direction:column; justify-content:center; align-items:center; font-size:24px; }
    button { font-size:20px; padding:10px 20px; margin-top:20px; cursor:pointer; }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="hud" style="display:none">
    <div>Time: <span id="time">0.0</span>s</div>
    <div>Cut: <span id="pct">0</span>%</div>
    <div id="best">Best Times:</div>
  </div>
  <div id="intro">
    <h1>Turbo Turf Trimmer</h1>
    <p>Press Start to mow the lawn!</p>
    <button onclick="startGame()">Start</button>
  </div>
  <div id="complete" style="display:none">
    <h1>Good job!</h1>
    <p>Your time: <span id="finalTime"></span>s</p>
    <button onclick="restartGame()">Restart</button>
  </div>
  <script>
  const canvas=document.getElementById('game'); const ctx=canvas.getContext('2d');
  let W,H,cols,rows,cell,total,cut,shade,cutAge,particles,cutCount,mower,state,startTime,elapsed,bestTimes=[];
  function resize(){ W=innerWidth; H=innerHeight; canvas.width=W; canvas.height=H; cell=20; cols=Math.floor(W/cell); rows=Math.floor(H/cell); total=cols*rows; initField(); }
  function idx(x,y){ return y*cols+x; }
  function initField(){ cutCount=0; cut=new Uint8Array(total); shade=new Float32Array(total); cutAge=new Float32Array(total); particles=[];
    for(let y=0;y<rows;y++)for(let x=0;x<cols;x++)shade[idx(x,y)]=Math.random();
    mower={x:W/2,y:H/2,vx:0,vy:0,dir:0,radius:25}; updatePercent(); updateTime(0); }
  function updatePercent(){ document.getElementById('pct').textContent=((cutCount/total*100)|0); }
  function updateTime(t){ document.getElementById('time').textContent=t.toFixed(1); }
  function handleCut(cx,cy){ if(cx<0||cy<0||cx>=cols||cy>=rows)return; const i=idx(cx,cy);
    if(!cut[i]){ cut[i]=1; cutCount++; cutAge[i]=1; spawnClippings(mower.x,mower.y); if(cutCount===total)onAllCut(); updatePercent(); } }
  function cutUnderMower(){ const r=mower.radius; const r2=r*r;
    const minx=Math.max(0,Math.floor((mower.x-r)/cell)),maxx=Math.min(cols-1,Math.floor((mower.x+r)/cell));
    const miny=Math.max(0,Math.floor((mower.y-r)/cell)),maxy=Math.min(rows-1,Math.floor((mower.y+r)/cell));
    for(let y=miny;y<=maxy;y++)for(let x=minx;x<=maxx;x++){ const cx=x*cell+cell/2,cy=y*cell+cell/2; const dx=cx-mower.x,dy=cy-mower.y;
      if(dx*dx+dy*dy<=r2)handleCut(x,y);} }
  function drawField(){ for(let y=0;y<rows;y++)for(let x=0;x<cols;x++){ const i=idx(x,y),s=shade[i];
      if(!cut[i]){ const g=135+Math.floor(s*70); ctx.fillStyle=`rgb(${10+Math.floor(s*10)},${g},${30+Math.floor(s*20)})`; }
      else{ const age=cutAge[i]||0; if(age>0){ const g=210+Math.floor(s*45); ctx.fillStyle=`rgb(${60+Math.floor(age*80)},${g},${80+Math.floor(age*80)})`; cutAge[i]=Math.max(0,age-lastDt*2.5); }
        else{ const g=170+Math.floor(s*60); ctx.fillStyle=`rgb(${20+Math.floor(s*15)},${g},${40+Math.floor(s*25)})`; } }
      ctx.fillRect(x*cell,y*cell,cell,cell);} }
  function drawMower(){ ctx.fillStyle='#f00'; ctx.beginPath(); ctx.arc(mower.x,mower.y,mower.radius,0,Math.PI*2); ctx.fill(); }
  function spawnClippings(x,y){ for(let i=0;i<8;i++){ const a=Math.random()*Math.PI*2; const sp=80+Math.random()*140;
      particles.push({x,y,vx:Math.cos(a)*sp,vy:Math.sin(a)*sp-40,life:0.5+Math.random()*0.35,size:2+Math.random()*2}); } }
  function updateParticles(dt){ const g=380; for(let i=particles.length-1;i>=0;i--){ const p=particles[i]; p.vy+=g*dt; p.x+=p.vx*dt; p.y+=p.vy*dt; p.life-=dt;
      if(p.life<=0||p.y>H+10)particles.splice(i,1);} }
  function drawParticles(){ ctx.save(); ctx.globalAlpha=0.9; for(const p of particles){ ctx.fillStyle='rgb(180,255,120)'; ctx.fillRect(p.x,p.y,p.size,p.size);} ctx.restore(); }
  let keys={}; onkeydown=e=>{keys[e.key]=1; if(state==='intro'&&(e.key==='Enter'))startGame();}; onkeyup=e=>{keys[e.key]=0;};
  function gameLoop(now){ const dt=Math.min(0.033,(now-last)/1000); last=now; lastDt=dt; if(state==='playing'){ const speed=160; if(keys['ArrowUp']||keys['w'])mower.vy=-speed; else if(keys['ArrowDown']||keys['s'])mower.vy=speed; else mower.vy=0;
      if(keys['ArrowLeft']||keys['a'])mower.vx=-speed; else if(keys['ArrowRight']||keys['d'])mower.vx=speed; else mower.vx=0; mower.x+=mower.vx*dt; mower.y+=mower.vy*dt; mower.x=Math.max(mower.radius,Math.min(W-mower.radius,mower.x)); mower.y=Math.max(mower.radius,Math.min(H-mower.radius,mower.y));
      cutUnderMower(); elapsed=(now-startTime)/1000; updateTime(elapsed);} ctx.clearRect(0,0,W,H); drawField(); updateParticles(dt); drawParticles(); if(state!=='intro')drawMower(); requestAnimationFrame(gameLoop); }
  function onAllCut(){ state='complete'; document.getElementById('complete').style.display='flex'; document.getElementById('finalTime').textContent=elapsed.toFixed(1);
    bestTimes.push(elapsed); bestTimes.sort((a,b)=>a-b); bestTimes=bestTimes.slice(0,5); localStorage.setItem('bestTimes',JSON.stringify(bestTimes)); renderBest(); }
  function startGame(){ document.getElementById('intro').style.display='none'; document.getElementById('hud').style.display='block'; state='playing'; startTime=performance.now(); elapsed=0; last=startTime; initField(); }
  function restartGame(){ document.getElementById('complete').style.display='none'; startGame(); }
  function renderBest(){ const el=document.getElementById('best'); el.innerHTML='Best Times:<br>'+bestTimes.map(t=>t.toFixed(1)+'s').join('<br>'); }
  window.addEventListener('resize',resize); let last=performance.now(),lastDt=0; resize(); bestTimes=JSON.parse(localStorage.getItem('bestTimes')||'[]'); renderBest(); let state='intro'; requestAnimationFrame(gameLoop);
  </script>
</body>
</html>